# üîê –°–∫—Ä–∏–ø—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Linux-—Å–µ—Ä–≤–µ—Ä–∞ (Debian/Ubuntu)

#### –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –±–∞–∑–æ–≤–æ–π –∑–∞—â–∏—Ç—ã –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Ñ–∞–µ—Ä–≤–æ–ª–∞, –ø–µ—Ä–µ–Ω–æ—Å SSH –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç, –∑–∞—â–∏—Ç—É –æ—Ç –ø–µ—Ä–µ–±–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ IPv6.

---

## üìå –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ sudo
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ (`apt update`) –∏ –ø–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (`apt full-upgrade -y`) —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
- –ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `sudo`, –æ–Ω –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.
- –í—ã–≤–æ–¥–∏—Ç—Å—è —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤, —á—Ç–æ–±—ã –≤—ã –≤–∏–¥–µ–ª–∏, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

---

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ nftables ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ–∞–π–µ—Ä–≤–æ–ª–∞
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ `nftables`, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è.
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ –ø—Ä–∞–≤–∏–ª–∞, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.
- –°–æ–∑–¥–∞—ë—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ –∏ —Ü–µ–ø–æ—á–∫–∞ `input` —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî **DROP** (–≤–µ—Å—å –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –∑–∞–ø—Ä–µ—â—ë–Ω).
- –†–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ:
  - —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (`established, related`);
  - –ª–æ–∫–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `lo`;
  - –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞–º–∏ SSH-–ø–æ—Ä—Ç.
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è **rate limiting** –¥–ª—è SSH ‚Äî –Ω–µ –±–æ–ª–µ–µ 4 –Ω–æ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –ø–µ—Ä–µ–±–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π.
- –ë–ª–æ–∫–∏—Ä—É—é—Ç—Å—è ICMP ping-–∑–∞–ø—Ä–æ—Å—ã ‚Äî —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–∏–Ω–≥–∏ –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–Ω–µ–µ –≤–∏–¥–∏–º—ã–º –≤ —Å–µ—Ç–∏.
- –ü—Ä–∞–≤–∏–ª–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã.

---

### 3. –ü–µ—Ä–µ–Ω–æ—Å SSH –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è SSH-–ø–æ—Ä—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 11953).
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SSH —Å–æ–∑–¥–∞—ë—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º.
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è SSH –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è –Ω–∞ –Ω–æ–≤–æ–º –ø–æ—Ä—Ç–µ.
- SSH-—Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.
- –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ SSH –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –Ω–æ–≤–æ–º –ø–æ—Ä—Ç–µ ‚Äî –µ—Å–ª–∏ –Ω–µ—Ç, –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ—à–∏–±–∫–æ–π.

---

### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Fail2ban ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
- –ï—Å–ª–∏ `fail2ban` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Äî —Å–∫—Ä–∏–ø—Ç –µ–≥–æ –ø–æ—Å—Ç–∞–≤–∏—Ç.
- –í–∫–ª—é—á–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å.
- –°–æ–∑–¥–∞—ë—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ `/etc/fail2ban/jail.local`:
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ **24 —á–∞—Å–∞** (86400 —Å–µ–∫—É–Ω–¥).
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ **4 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫** –≤—Ö–æ–¥–∞ –∑–∞ 10 –º–∏–Ω—É—Ç.
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –ª–æ–≥–∏ SSH –Ω–∞ –≤–∞—à–µ–º –Ω–æ–≤–æ–º –ø–æ—Ä—Ç–µ.
- –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ fail2ban –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.
- –°–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç—É—Å fail2ban, —á—Ç–æ–±—ã –≤—ã –±—ã–ª–∏ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

### 5. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ IPv6
- –í –∫–æ–Ω—Ñ–∏–≥ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ GRUB –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä `ipv6.disable=1`.
- –°–æ–∑–¥–∞—ë—Ç—Å—è sysctl –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è IPv6 –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö.
- –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ sysctl.
- –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è IPv6 –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ **–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–µ—Ä–≤–µ—Ä**.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:
- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –ø—Ä–∞–≤–∞–º–∏ root –∏–ª–∏ —á–µ—Ä–µ–∑ sudo.

- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

   ```bash
   bash <(curl -sSL https://raw.githubusercontent.com/StressOzz/vps-setup/main/vps-settings.sh)

- –í–≤–µ–¥–∏—Ç–µ SSH-–ø–æ—Ä—Ç –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (11953).

- –î–æ–∂–¥–∏—Ç–µ—Å—å –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞.

- –°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.
